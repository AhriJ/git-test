{
  "inode": {
    "org": "",
    "id": "cmdb_workflow-1onnhce2sssv3",
    "schema_id": "cmdb_schema_workflow-0",
    "name": "(test)[告警回调][om.native.v2] 微信+slack",
    "namespace": "",
    "descr": "",
    "ctime": 0,
    "mtime": 0,
    "creator": "",
    "last_editor": "",
    "archived": false,
    "lock": ""
  },
  "data": {
    "edges": [
      {
        "from": "__START__",
        "to": "生成告警信息"
      },
      {
        "from": "生成告警信息",
        "to": "迭代webhook数组"
      },
      {
        "from": "发送告警",
        "to": "__END__"
      },
      {
        "from": "迭代webhook数组#iterate",
        "to": "发送告警"
      }
    ],
    "icon": "",
    "nodes": [
      {
        "name": "__START__",
        "component": "cmdb_component-vars",
        "descr": "自定义表单",
        "auto_run": true,
        "settings": {},
        "config": {
          "schema": {
            "type": "object",
            "properties": {
              "body": {
                "type": "object",
                "properties": {}
              }
            },
            "required": []
          }
        },
        "inputs": {
          "*": {
            "body": {
              "adjust": {},
              "metric": {},
              "notes": {},
              "policy": {},
              "receiver": [],
              "tags": {},
              "trigger": {}
            }
          }
        },
        "merge": {
          "enable": false
        }
      },
      {
        "name": "__END__",
        "component": "cmdb_component-vars",
        "descr": "自定义表单",
        "auto_run": true,
        "settings": {},
        "config": {}
      },
      {
        "name": "迭代webhook数组",
        "component": "cmdb_component-foreach",
        "descr": "列表迭代",
        "auto_run": true,
        "settings": {},
        "config": {
          "iterate_config": {
            "mode": "best-effort",
            "max_parallel": 3
          },
          "output_config": {
            "mode": "by-batch",
            "batch_size": 3
          }
        },
        "merge": {
          "enable": false
        },
        "inputs": {
          "生成微信告警信息": "{var:生成微信告警信息.output.webhook}",
          "生成告警信息": "{var:生成告警信息.output.webhook}"
        }
      },
      {
        "name": "发送告警",
        "component": "cmdb_component-request",
        "descr": "Request",
        "auto_run": true,
        "settings": {},
        "config": {
          "request_content_type": "json",
          "response_body_schema": "{\"type\":\"object\",\"properties\":{}}",
          "request_body_schema": "{\"type\":\"object\",\"properties\":{}}"
        },
        "merge": {
          "enable": false
        },
        "inputs": {
          "": {
            "tls_config": {},
            "body": {
              "body": {}
            }
          },
          "迭代webhook数组#iterate": {
            "tls_config": {
              "insecure_skip_verify": true
            },
            "body": {
              "0": "{",
              "1": "}",
              "body": "{var:迭代webhook数组#iterate.output.content}"
            },
            "hosts": [
              "{var:迭代webhook数组#iterate.output.host}"
            ],
            "url": "{var:迭代webhook数组#iterate.output.path}",
            "method": "POST",
            "headers": [
              {
                "name": "Content-Type",
                "value": "application/json"
              }
            ],
            "client_timeout_ms": 30000
          }
        }
      },
      {
        "auto_run": true,
        "component": "cmdb_component-interpreter_ecmascript",
        "config": {
          "script": "resources/scripts/cmdb_workflow-1onnhce2sssv3.data.nodes.4.config.script.js",
          "input_schema": "{\"type\":\"object\",\"properties\":{}}",
          "output_schema": "{\"type\":\"object\",\"properties\":{\"content\":{\"type\":\"string\",\"title\":\"告警内容\"},\"error\":{\"type\":\"string\",\"title\":\"错误信息\"},\"level\":{\"type\":\"integer\",\"title\":\"分组\"},\"webhook\":{\"type\":\"array\",\"items\":{\"type\":\"object\",\"properties\":{\"host\":{\"type\":\"string\"},\"path\":{\"type\":\"string\"},\"content\":{\"type\":\"object\",\"properties\":{}}},\"required\":[]}}},\"required\":[\"content\",\"error\",\"level\"],\"title\":\"告警内容\"}"
        },
        "descr": "ES2015 解析组件",
        "inputs": {
          "__START__": "{var:__START__.output.body}"
        },
        "merge": {
          "enable": false
        },
        "name": "生成告警信息",
        "settings": {},
        "debug": false
      }
    ],
    "persist_level": "job_unit",
    "persist_retention": 604800
  },
  "indexes": {}
}